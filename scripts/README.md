# Database Migration Scripts

## Для пользователя (вы)

### Быстрые команды

После создания новой миграции, просто скажите мне (AI агенту):

> "Примени миграции" или "Run migrations"

Я автоматически запущу нужные команды.

---

## Для AI агента (меня)

### Как применить миграции

Когда пользователь просит применить миграции, выполни:

```bash
npm run migrate
```

Этот скрипт:
1. ✅ Проверит установку Supabase CLI
2. ✅ Проверит подключение к проекту
3. ✅ Применит все новые миграции
4. ✅ Обновит TypeScript типы

### Альтернативные команды

**Только применить миграции:**
```bash
npm run db:push
```

**Только обновить типы:**
```bash
npm run db:types
```

**Скачать схему из удаленной БД:**
```bash
npm run db:pull
```

---

## Доступные скрипты

| Команда | Описание |
|---------|----------|
| `npm run migrate` | Полный процесс: миграции + типы (рекомендуется) |
| `npm run db:push` | Только применить миграции |
| `npm run db:types` | Только сгенерировать типы |
| `npm run db:pull` | Скачать текущую схему из Supabase |

---

## Требования

- Supabase CLI должен быть установлен
- Проект должен быть подключен (`supabase link --project-ref XXX`)
- Вы должны быть залогинены (`supabase login`)

---

## Устранение проблем

**Ошибка: "Supabase CLI is not installed"**
```bash
# Установите Supabase CLI
npm install -g supabase
```

**Ошибка: "Remote migration versions not found"**
```bash
# Синхронизируйте удаленное состояние
supabase db remote commit
# Затем снова примените миграции
npm run migrate
```

**Ошибка: "Not logged in"**
```bash
supabase login
```
